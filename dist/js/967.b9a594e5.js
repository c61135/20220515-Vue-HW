"use strict";(self["webpackChunknew_project"]=self["webpackChunknew_project"]||[]).push([[967],{967:function(t,e,o){o.r(e),o.d(e,{default:function(){return ot}});var a=o(6252),n=o(3577);const s={class:"d-flex justify-content-between mt-3"},i={class:"table mt-5 py-5"},l=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"200"},"名稱"),(0,a._)("th",{width:"200"},"折扣碼"),(0,a._)("th",{width:"300"},"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",{width:"100"},"是否啟用"),(0,a._)("th",{width:"200"},"編輯")])],-1),d={width:"200"},p={width:"200"},u={width:"300"},c={key:0,class:"text-success"},h={class:"btn-group"},r=["onClick"],g=["onClick"],m={class:"toast-container d-flex flex-column position-absolute top-0 end-0 toastMargin"};function _(t,e,o,_,b,w){const C=(0,a.up)("LoadingStatus"),f=(0,a.up)("PaginationList"),v=(0,a.up)("DeleteModal"),k=(0,a.up)("CouponModal"),x=(0,a.up)("ToastCard");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(C,{active:b.isLoading},null,8,["active"]),(0,a._)("div",s,[(0,a._)("button",{type:"button",class:"btn btn-success m-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:e[0]||(e[0]=t=>w.openCouponModal(!0))}," 新增折價券 "),(0,a.Wm)(f,{type:"coupons",onPrePage:w.showcoupons,onChangePage:w.showcoupons,onNextPage:w.showcoupons},null,8,["onPrePage","onChangePage","onNextPage"])]),(0,a._)("table",i,[l,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.coupons,((t,e)=>((0,a.wg)(),(0,a.iD)("tr",{key:e},[(0,a._)("td",d,(0,n.zw)(t.title),1),(0,a._)("td",p,(0,n.zw)(t.code),1),(0,a._)("td",u,(0,n.zw)(t.percent),1),(0,a._)("td",null,(0,n.zw)(t.due_date),1),(0,a._)("td",null,[((0,a.wg)(),(0,a.iD)("span",c,"啟用"))]),(0,a._)("td",null,[(0,a._)("div",h,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>w.openCouponModal(!1,t)}," 編輯",8,r),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:o=>w.openDelModal(t,e)},"刪除",8,g),(0,a.Wm)(v,{ref_for:!0,ref:"delModal",delTitle:t.title,delId:t.id,index:e,onDeleteProduct:w.deleteCoupon},null,8,["delTitle","delId","index","onDeleteProduct"])])])])))),128))])]),(0,a.Wm)(k,{ref:"couponModal",isNew:b.isNew,tempCoupon:b.tempCoupon,onEditCoupon:w.addData},null,8,["isNew","tempCoupon","onEditCoupon"]),(0,a._)("div",m,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.toastList,((t,e)=>((0,a.wg)(),(0,a.j4)(x,{key:e,msg:t},null,8,["msg"])))),128))])],64)}var b=o(9963);const w={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"couponModal"},C={class:"modal-dialog modal-xl",role:"document"},f={class:"modal-content border-0"},v={class:"modal-header bg-dark"},k={key:0,class:"modal-title text-white",id:"exampleModalLabel"},x={key:1,class:"modal-title text-white",id:"exampleModalLabel"},y=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),M={class:"modal-body"},P={class:"mb-3"},$={for:"title",class:"form-label w-100"},D=(0,a.Uk)(" 折價券名稱 "),L={class:"mb-3"},N={for:"code",class:"form-label w-100"},U=(0,a.Uk)(" 折扣碼 "),Z={class:"mb-3"},z={for:"percent",class:"form-label w-100"},j=(0,a.Uk)(" 折扣百分比 "),T={class:"mb-3"},V={for:"due_date",class:"form-label w-100"},Y=(0,a.Uk)(" 到期日 "),H={class:"mb-3"},W={class:"form-check"},K={class:"form-check-label",for:"is_enabled"},A=(0,a.Uk)(" 是否啟用 "),E={class:"modal-footer"},I=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function B(t,e,o,n,s,i){return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",C,[(0,a._)("div",f,[(0,a._)("div",v,[o.isNew?((0,a.wg)(),(0,a.iD)("h5",k," 新增折價券 ")):((0,a.wg)(),(0,a.iD)("h5",x," 編輯折價券 ")),y]),(0,a._)("div",M,[(0,a._)("div",P,[(0,a._)("label",$,[D,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入折價券名稱","onUpdate:modelValue":e[0]||(e[0]=t=>s.editCoupon.title=t)},null,512),[[b.nr,s.editCoupon.title]])])]),(0,a._)("div",L,[(0,a._)("label",N,[U,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入折扣碼","onUpdate:modelValue":e[1]||(e[1]=t=>s.editCoupon.code=t)},null,512),[[b.nr,s.editCoupon.code]])])]),(0,a._)("div",Z,[(0,a._)("label",z,[j,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣","onUpdate:modelValue":e[2]||(e[2]=t=>s.editCoupon.percent=t)},null,512),[[b.nr,s.editCoupon.percent]])])]),(0,a._)("div",T,[(0,a._)("label",V,[Y,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入到期日","onUpdate:modelValue":e[3]||(e[3]=t=>s.editCoupon.due_date=t)},null,512),[[b.nr,s.editCoupon.due_date]])])]),(0,a._)("div",H,[(0,a._)("div",W,[(0,a._)("label",K,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":e[4]||(e[4]=t=>s.editCoupon.is_enabled=t)},null,512),[[b.e8,s.editCoupon.is_enabled]]),A])])])]),(0,a._)("div",E,[I,(0,a._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[5]||(e[5]=t=>i.sendData())},"確認")])])])],512)}var F=o(7424),S=o.n(F),q={props:["isNew","tempCoupon"],data(){return{editCoupon:{}}},watch:{tempCoupon(){this.editCoupon=this.tempCoupon}},methods:{openModal(){this.couponModal.show()},closeModal(){this.couponModal.hide()},sendData(){this.editCoupon.due_date=Date.parse(this.editCoupon.due_date),this.$emit("editCoupon",this.editCoupon)}},mounted(){this.couponModal=new(S())(this.$refs.couponModal),this.editCoupon=this.tempCoupon}},G=o(3744);const J=(0,G.Z)(q,[["render",B]]);var O=J,Q=o(3587),R=o(9958),X=o(4194),tt={name:"dashBoard",components:{CouponModal:O,DeleteModal:Q.Z,PaginationList:R.Z,ToastCard:X.Z},data(){return{tempCoupon:{},coupons:{},isNew:!0,isLoading:!1,toastList:[],toastCard:[]}},methods:{showcoupons(t){const e=`https://vue3-course-api.hexschool.io/api/ping-api/admin/coupons?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.coupons=t.data.coupons;for(let e=0;e<this.coupons.length;e++){const t=new Date(this.coupons[e].due_date);this.coupons[e].due_date=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()}`}this.isLoading=!1}))},openCouponModal(t,e={}){this.isNew=t,this.tempCoupon=e,this.$refs.couponModal.openModal()},addData(t){if(this.tempCoupon=t,this.isNew){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/ping-api/admin/coupon";this.$http.post(t,{data:this.tempCoupon}).then((t=>{console.log("add",t),this.showcoupons(),this.isLoading=!1;const e={title:"新增折價券",...t.data};this.toastList.push(e)}))}else{this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/ping-api/admin/coupon/${this.tempCoupon.id}`;this.$http.put(t,{data:this.tempCoupon}).then((t=>{this.showcoupons(),console.log("edit",t),this.isLoading=!1;const e={title:"編輯折價券",...t.data};this.toastList.push(e)}))}this.tempCoupon={}},openDelModal(t,e){this.$refs.delModal[e].openModal()},deleteCoupon(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/ping-api/admin/coupon/${t}`;this.$http.delete(e,{data:this.coupons}).then((t=>{this.showcoupons();const e={title:"刪除產品",...t.data};this.toastList.push(e),this.isLoading=!1}))}},created(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=t;const e="https://vue3-course-api.hexschool.io/api/user/check";this.isLoading=!0,this.$http.post(e).then((t=>{console.log("登入中",t)})),this.showcoupons(),this.isLoading=!1},mounted(){}};const et=(0,G.Z)(tt,[["render",_]]);var ot=et},9958:function(t,e,o){o.d(e,{Z:function(){return _}});var a=o(6252),n=o(9963),s=o(3577);const i={class:"booksPagination d-flex justify-content-center"},l=(0,a._)("span",{"aria-hidden":"true"},"«",-1),d=[l],p=["onClick"],u=(0,a._)("span",{"aria-hidden":"true"},"»",-1),c=[u];function h(t,e,o,l,u,h){return(0,a.wg)(),(0,a.iD)("ul",i,[(0,a._)("li",null,[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,n.iM)((t=>h.prePage()),["prevent"]))},d)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(u.pagination.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t},[(0,a._)("a",{class:(0,s.C_)(["page-link",{pageActive:t==u.pagination.current_page}]),href:"#",onClick:(0,n.iM)((e=>h.changePage(t)),["prevent"])},(0,s.zw)(t),11,p)])))),128)),(0,a._)("li",null,[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,n.iM)((t=>h.nextPage()),["prevent"]))},c)])])}var r={props:["type"],data(){return{pagination:{},page:1}},methods:{getPages(){const t=`https://vue3-course-api.hexschool.io/api/ping-api/admin/${this.type}?page=${this.page}`;this.$http.get(t).then((t=>{this.pagination=t.data.pagination}))},prePage(){this.pagination.has_pre&&(this.page-=1,this.$emit("prePage",this.page),this.getPages())},changePage(t){this.page=t,console.log("change",this.page),this.getPages(),console.log("change",this.page),this.$emit("changePage",this.page),console.log("change",this.page)},nextPage(){this.pagination.has_next&&(this.page+=1,this.$emit("changePage",this.page),this.getPages())}},mounted(){this.getPages()}},g=o(3744);const m=(0,g.Z)(r,[["render",h]]);var _=m}}]);
//# sourceMappingURL=967.b9a594e5.js.map